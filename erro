# 1. Call MCP-based RAG tool first
    try:
        rag_response = await ansibleplus_rag_stub(
            context="\n".join(dialog),
            question=final_problem_statement,
            session_id=session_id
        )
        if rag_response and isinstance(rag_response, dict):
            if "error" not in rag_response:
                documentation = rag_response.get("answer", "").split("\n")
    except Exception as e:
        logger.error("RAG call failed:", e)
