from fastmcp import MultiServerMCPClient

client = MultiServerMCPClient({
    "ansibleplus": {
        "url": "http://localhost:8080/mcp/",
        "transport": "streamable_http"
    }
})

async def ansibleplus_rag_stub(context: str, question: str, session_id: str):
    try:
        response = await client.query(
            tool="ansibleplus.rag",
            input={
                "context": context,
                "question": question,
                "session_id": session_id
            }
        )
        return response
    except Exception as e:
        return {"status": "error", "message": str(e)}
