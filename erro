import re

def sanitize_for_llm(raw: str) -> str:
    # 1. Decode escape sequences (\t, \r\n, etc.)
    cleaned = raw.encode("utf-8").decode("unicode_escape", errors="ignore")

    # 2. Remove excessive backslashes around quotes
    cleaned = cleaned.replace("\\\"", "\"").replace("\\\\", "\\")

    # 3. Mask long IDs, ARNs, account numbers, tokens (12+ digit or hex strings)
    cleaned = re.sub(r"\b[a-zA-Z0-9:/\-_]{15,}\b", "[REDACTED_ID]", cleaned)

    # 4. Mask numeric account/project IDs (10â€“16 digits)
    cleaned = re.sub(r"\b\d{10,16}\b", "[REDACTED_NUMBER]", cleaned)

    # 5. Mask URLs (http/https)
    cleaned = re.sub(r"https?://[^\s]+", "[REDACTED_URL]", cleaned)

    # 6. Normalize whitespace
    cleaned = re.sub(r"\s+", " ", cleaned).strip()

    return cleaned
