# ... (imports and other code) ...

class SimpleLangGraphApp:
    # ... (init and set_up methods are the same as before) ...

    def query(self, input_message: str):
        if self.graph is None:
            raise RuntimeError("Graph not set up. Call set_up() first.")

        # --- FALLBACK MODIFICATION (if previous attempt failed) ---
        # Convert HumanMessage conceptual message into the required dict format
        # This will satisfy the ValueError if it's happening at the graph's entry point
        # expecting a plain dict for initial message state.
        input_message_as_dict = {"role": "user", "content": input_message}

        print(f"DEBUG: Invoking graph with input_message_as_dict: {input_message_as_dict}")
        result = self.graph.invoke({"messages": [input_message_as_dict]}) # Pass the list containing the dictionary
        return result

# ... (rest of your code) ...
